{% include 'header.html' %}
<div class="card card-style">
    <div class="content mb-0">
        <p class="mb-n1 color-highlight font-600">Aurora</p>
        <h1>Custom Settings</h1>
        <p class="mb-3">
            Adjust HDMI capture and Aurora settings to fine-tune your ambient lighting experience.
        </p>

        <!-- System Status -->
        <div class="d-flex content mb-3 pb-3" style="border-bottom: 1px solid rgba(0,0,0,0.1);">
            <div class="pt-1">
                <h5 class="font-700 font-14">System Status</h5>
            </div>
            <div class="ml-auto mr-4 pr-2">
                <div class="custom-control ios-switch ios-switch-icon">
                    <input data-vibrate="200" type="checkbox" {%if enabled == True %}checked="checked"{% endif %} style="visibility: hidden" class="ios-input" id="toggle_aurora_enabled">
                    <label class="custom-control-label" for="toggle_aurora_enabled"></label>
                    <span>ON</span>
                    <span>OFF</span>
                </div>
            </div>
        </div>

        <!-- Extension Selector -->
        <div class="mb-4">
            <h5 class="font-16 font-700 mb-2">Current Extension <span class="font-11 opacity-70">({{fps}} FPS)</span></h5>
            <select class="form-control" id="extension_selector">
                {% for key, extension in extensions_meta.items() %}
                <option value="{{key}}" {% if key == current_extension_meta.FileName %}selected{% endif %}>{{extension.Name}}</option>
                {% endfor %}
            </select>
        </div>

        <div class="divider mb-3"></div>

        <h5 class="font-16 font-700 mb-2">HDMI Capture Settings</h5>
        <p class="font-11 opacity-70 mb-3">Adjust the video input settings for optimal color capture</p>
        
        <div class="row mb-3">
            <div class="col-4 pt-2">
                <span class="font-13">Brightness</span>
            </div>
            <div class="col-8">
                <input id="hdmi_brightness" type="range" data-slider-min="-64" data-slider-max="64" data-slider-step="1"
                    data-slider-value="{{hdmi_brightness}}" />
                <span id="brightness_value" class="font-11 opacity-70">{{hdmi_brightness}}</span>
            </div>
        </div>

        <div class="row mb-3">
            <div class="col-4 pt-2">
                <span class="font-13">Saturation</span>
            </div>
            <div class="col-8">
                <input id="hdmi_saturation" type="range" data-slider-min="0" data-slider-max="255" data-slider-step="1"
                    data-slider-value="{{hdmi_saturation}}" />
                <span id="saturation_value" class="font-11 opacity-70">{{hdmi_saturation}}</span>
            </div>
        </div>

        <div class="row mb-3">
            <div class="col-4 pt-2">
                <span class="font-13">Contrast</span>
            </div>
            <div class="col-8">
                <input id="hdmi_contrast" type="range" data-slider-min="0" data-slider-max="255" data-slider-step="1"
                    data-slider-value="{{hdmi_contrast}}" />
                <span id="contrast_value" class="font-11 opacity-70">{{hdmi_contrast}}</span>
            </div>
        </div>

        <div class="row mb-4">
            <div class="col-4 pt-2">
                <span class="font-13">Hue</span>
            </div>
            <div class="col-8">
                <input id="hdmi_hue" type="range" data-slider-min="-40" data-slider-max="40" data-slider-step="1"
                    data-slider-value="{{hdmi_hue}}" />
                <span id="hue_value" class="font-11 opacity-70">{{hdmi_hue}}</span>
            </div>
        </div>

        <div class="divider mb-3"></div>

        <h5 class="font-16 font-700 mb-2">Aurora Settings</h5>
        <p class="font-11 opacity-70 mb-3">Fine-tune color and brightness behavior</p>

        <div class="row mb-3">
            <div class="col-4 pt-2">
                <span class="font-13">Gamma</span>
            </div>
            <div class="col-8">
                <input id="aurora_gamma" type="range" data-slider-min="0.1" data-slider-max="3.0" data-slider-step="0.1"
                    data-slider-value="{{aurora_gamma}}" />
                <span id="gamma_value" class="font-11 opacity-70">{{aurora_gamma}}</span>
            </div>
        </div>

        <div class="row mb-4">
            <div class="col-4 pt-2">
                <span class="font-13">Dark Threshold</span>
            </div>
            <div class="col-8">
                <input id="aurora_dark_threshold" type="range" data-slider-min="0" data-slider-max="100" data-slider-step="1"
                    data-slider-value="{{aurora_dark_threshold}}" />
                <span id="dark_threshold_value" class="font-11 opacity-70">{{aurora_dark_threshold}}</span>
            </div>
        </div>

        <div class="divider mb-3"></div>

        <!-- Preview Section -->
        <div class="mb-4">
            <div class="d-flex">
                <h5 class="font-16 font-700 mb-2">Live Preview</h5>
                <div class="ml-auto">
                    <a href="#" id="refresh_preview_button" class="btn btn-xs rounded-xs text-uppercase font-900 shadow-s bg-blue-light">
                        <i class="fa fa-sync"></i> Refresh
                    </a>
                </div>
            </div>
            <p class="font-11 opacity-70 mb-3">See the effect of your changes</p>
            {% if enabled %}
            <img class="img-fluid rounded-s" id="preview_screenshot" src="/load_screenshot?t={{timestamp}}" 
                 onerror="this.style.display='none';" 
                 alt="HDMI Preview" />
            {% else %}
            <div class="alert bg-blue-dark rounded-s text-center" style="padding: 60px 20px;">
                <i class="fa fa-info-circle fa-3x mb-3 opacity-50"></i>
                <p class="mb-0 opacity-70">Enable Aurora to see live preview</p>
            </div>
            {% endif %}
        </div>

        <div class="divider mb-3"></div>

        <div class="row">
            <div class="col-6">
                <a href="#" id="reset_button"
                    class="btn btn-m btn-full mb-3 rounded-xs text-uppercase font-900 shadow-s bg-red-light">
                    <i class="fa fa-undo"></i> Reset
                </a>
            </div>
            <div class="col-6">
                <a href="#" id="save_settings_button"
                    class="btn btn-m btn-full mb-3 rounded-xs text-uppercase font-900 shadow-s bg-green-dark">
                    <i class="fa fa-save"></i> Save
                </a>
            </div>
        </div>

        <div class="alert bg-blue-dark mb-3" role="alert" style="display:none;" id="status_message">
            <span class="alert-icon"><i class="fa fa-check-circle"></i></span>
            <strong class="font-13">Success!</strong>
            <p id="status_text" class="font-11"></p>
            <button type="button" class="close color-white opacity-60 font-16" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>

    </div>
</div>
{% include 'footer.html' %}
